{"version":3,"file":"processor.js","sources":["../../src/concurrency/processor.ts"],"sourcesContent":["import { Logger, LOG_LEVEL_VERBOSE } from \"../common/logger\";\nimport type { ReactiveSource } from \"../dataobject/reactive\";\nimport { RESULT_TIMED_OUT } from \"../common/const\";\nimport { noop, delay, fireAndForget, promiseWithResolver, PromiseWithResolvers } from \"../promises\";\nexport class Notifier {\n\n    _p: PromiseWithResolvers<void> = promiseWithResolver<void>();\n    isUsed = false;\n    notify() {\n        if (!this.isUsed) {\n            return;\n        }\n        this.isUsed = false;\n        this._p.promise.finally(noop)\n        this._p.resolve()\n        this._p = promiseWithResolver();\n    }\n    get nextNotify(): Promise<void> {\n        this.isUsed = true;\n        return this._p.promise;\n    }\n}\nlet processNo = 0;\n\nconst allRunningProcessors = new Set<QueueProcessor<any, any>>([]);\n\n/**\n * QueueProcessor Parameters\n */\ntype ProcessorParams<T> = {\n    /**\n     * How many processes runs concurrently\n     */\n    concurrentLimit?: number;\n    /**\n     * Number of entities passed to the processor at once\n     */\n    batchSize?: number;\n    /**\n     * Numbers of queued entities to ignore delay and run immediately\n     */\n    yieldThreshold?: number;\n    /**\n     * Time(ms) to ignore yieldThreshold and run process\n     */\n    delay?: number;\n    interval?: number;\n    maintainDelay?: boolean;\n    suspended: boolean;\n    /**\n     * ReactiveSource to notify the remaining count.\n     */\n    remainingReactiveSource?: ReactiveSource<number>;\n    /**\n     * ReactiveSource to notify the total remaining count.\n     */\n    totalRemainingReactiveSource?: ReactiveSource<number>;\n    /**\n     * ReactiveSource to notify how many items are processing;\n     */\n    processingEntitiesReactiveSource?: ReactiveSource<number>;\n    /**\n     * If true, processed result will be buffered until a downstream has been connected.\n     */\n    keepResultUntilDownstreamConnected?: boolean;\n    pipeTo?: QueueProcessor<T, any>;\n};\n\ntype ProcessorResult<T> = Promise<T[]> | T[] | undefined | void | Promise<void> | Promise<undefined>;\ntype Processor<T, U> = (entity: T[]) => ProcessorResult<U>\nexport class QueueProcessor<T, U> {\n    _queue: T[] = [];\n    _processor: Processor<T, U>;\n    _enqueueProcessor: (queue: T[], newEntity: T) => T[] = (queue, entity) => (queue.push(entity), queue);\n    _isSuspended = true;\n    _nextProcessNeedsImmediate = false;\n\n    _pipeTo?: QueueProcessor<U, any>;\n\n    _waitId: string = \"\";\n    _root?: QueueProcessor<any, any> = undefined;\n    _instance = processNo++;\n    _remainingReactiveSource?: ReactiveSource<number>;\n    _totalRemainingReactiveSource?: ReactiveSource<number>;\n    _processingEntitiesReactiveSource?: ReactiveSource<number>;\n    _keepResultUntilDownstreamConnected = false;\n    _keptResult = [] as U[];\n\n    _runOnUpdateBatch: () => void = () => { };\n\n    // Parameters\n\n    // How many processes running concurrently\n    concurrentLimit: number = 1;\n\n    // How many entries processed at once\n    batchSize: number = 1;\n\n    // How many entries kept in before the delay\n    yieldThreshold: number = 1;\n\n    // If set, wait for set milliseconds after enqueued\n    // Note: If reached to the batchSize, run immediately\n    delay: number = 0;\n    maintainDelay: boolean;\n    interval: number = 0;\n\n    // This means numbers of the entities which are now processing\n    processingEntities: number = 0;\n\n    // This means numbers of the entries which dequeued from the queue but not processed yet.\n    waitingEntries: number = 0;\n\n    get nowProcessing(): number {\n        return this.processingEntities\n    }\n    get totalNowProcessing(): number {\n        return this.nowProcessing + (this._pipeTo?.totalNowProcessing || 0);\n    }\n\n    get remaining(): number {\n        return this._queue.length + this.processingEntities + this.waitingEntries;\n    }\n    get totalRemaining(): number {\n        return this.remaining + (this._pipeTo?.totalRemaining || 0);\n    }\n    updateStatus(setFunc: () => void): void {\n        setFunc();\n        this._updateReactiveSource();\n    }\n\n    suspend(): QueueProcessor<T, U> {\n        this._isSuspended = true;\n        this._notifier.notify();\n        return this;\n    }\n\n    resume(): this {\n        this._isSuspended = false;\n        this._notifier.notify();\n        this.requestNextFlush();\n        this._run();\n        return this;\n    }\n    resumePipeLine(): this {\n        this._pipeTo?.resumePipeLine();\n        this.resume();\n        return this;\n    }\n    startPipeline(): this {\n        this.root.resumePipeLine();\n        return this;\n    }\n    get root(): QueueProcessor<any, any> {\n        if (this._root === undefined) {\n            return this;\n        }\n        return this._root;\n    }\n\n    _notifier: Notifier = new Notifier();\n\n    constructor(processor: Processor<T, U>, params?: ProcessorParams<U>, items?: T[], enqueueProcessor?: (queue: T[], newEntity: T) => T[]) {\n        this._root = this;\n        this._processor = processor;\n        this.batchSize = params?.batchSize ?? 1;\n        this.yieldThreshold = params?.yieldThreshold ?? params?.batchSize ?? 0;\n        this.concurrentLimit = params?.concurrentLimit ?? 1;\n        this.delay = params?.delay ?? 0;\n        this.maintainDelay = params?.maintainDelay ?? false;\n        this.interval = params?.interval ?? 0;\n        if (params?.keepResultUntilDownstreamConnected) this._keepResultUntilDownstreamConnected = params.keepResultUntilDownstreamConnected;\n        if (params?.remainingReactiveSource) this._remainingReactiveSource = params?.remainingReactiveSource;\n        if (params?.totalRemainingReactiveSource) this._totalRemainingReactiveSource = params?.totalRemainingReactiveSource;\n        if (params?.processingEntitiesReactiveSource) this._processingEntitiesReactiveSource = params?.processingEntitiesReactiveSource;\n        if (params?.suspended !== undefined) this._isSuspended = params?.suspended;\n        if (enqueueProcessor) this.replaceEnqueueProcessor(enqueueProcessor);\n        if (params?.pipeTo !== undefined) {\n            this.pipeTo(params.pipeTo);\n        }\n        if (items) this.enqueueAll(items);\n        allRunningProcessors.add(this);\n        this._run();\n    }\n\n    /**\n     * replace enqueue logic.\n     * @param processor enqueue logic. this should return new queue.\n     * @returns \n     */\n    replaceEnqueueProcessor(processor: (queue: T[], newItem: T) => T[]): this {\n        this._enqueueProcessor = processor;\n        return this;\n    }\n\n    /**\n     * Modify the queue by force. \n     * @param processor \n     * @remarks I know that you have known this is very dangerous.\n     */\n    modifyQueue(processor: (queue: T[]) => T[]): void {\n        this._queue = processor(this._queue);\n        this._notifier.notify();\n    }\n\n    /**\n     * Clear the queue\n     * @remarks I know that you have known this is very dangerous.\n     */\n    clearQueue(): void {\n        this._queue = [];\n        this._notifier.notify();\n    }\n\n    /**\n     * Set the handler for when the queue has been modified\n     * @param proc \n     * @returns \n     */\n    onUpdateProgress(proc: () => void): this {\n        this._runOnUpdateBatch = proc;\n        return this;\n    }\n\n    /**\n     * Join another processor\n     * @param pipeTo \n     * @returns \n     */\n    pipeTo<V>(pipeTo: QueueProcessor<U, V>): QueueProcessor<U, V> {\n        this._pipeTo = pipeTo;\n        this._pipeTo._root = this.root;\n        // If something buffered, send to the downstream.\n        if (this._keptResult.length > 0) {\n            const temp = [...this._keptResult];\n            this._keptResult = [];\n            this._pipeTo.enqueueAll(temp);\n        }\n        return pipeTo;\n    }\n\n    isIdle(): boolean {\n        return this._isIdle() && (!this._pipeTo ? true : this._pipeTo.isIdle());\n    }\n    _isIdle(): boolean {\n        return this.totalRemaining == 0;\n    }\n    async _idleDetector(): Promise<void> {\n        if (this._isSuspended) return Promise.resolve();\n        if (this._isIdle()) return Promise.resolve();\n        do {\n            await Promise.race([delay(3000), this._notifier.nextNotify]);\n        } while (!this._isIdle());\n        return Promise.resolve();\n    }\n\n    idleDetectors(): Promise<void>[] {\n        const thisPromise = this._idleDetector();\n        if (this._pipeTo) {\n            return [thisPromise, ...this._pipeTo.idleDetectors()];\n        }\n        return [thisPromise];\n    }\n\n    get isSuspended(): boolean {\n        return this._isSuspended || this._pipeTo?.isSuspended || false;\n    }\n\n\n    _updateReactiveSource(): void {\n        this.root.updateReactiveSource();\n    }\n    updateReactiveSource(): void {\n        if (this._pipeTo) {\n            this._pipeTo.updateReactiveSource();\n        }\n        if (this._remainingReactiveSource) this._remainingReactiveSource.value = this.remaining;\n        if (this._totalRemainingReactiveSource) this._totalRemainingReactiveSource.value = this.totalRemaining;\n        if (this._processingEntitiesReactiveSource) this._processingEntitiesReactiveSource.value = this.nowProcessing;\n\n    }\n    _updateBatchProcessStatus(): void {\n        this._updateReactiveSource();\n        this._runOnUpdateBatch();\n    }\n\n    _collectBatch(): T[] {\n        return this._queue.splice(0, this.batchSize);\n    }\n    _canCollectBatch(): boolean {\n        return this._queue.length !== 0;\n    }\n\n\n    enqueue(entity: T): this {\n        this._queue = this._enqueueProcessor(this._queue, entity);\n        this._updateBatchProcessStatus()\n        this._notifier.notify();\n        return this;\n    }\n    enqueueAll(entities: T[]): this {\n        let queue = this._queue;\n        for (const v of entities) {\n            queue = this._enqueueProcessor(queue, v);\n        }\n        this._queue = queue;\n        this._updateBatchProcessStatus()\n        this._notifier.notify();\n        return this;\n    }\n\n    requestNextFlush(): void {\n        if (this._canCollectBatch()) {\n            this._nextProcessNeedsImmediate = true;\n            this._notifier.notify();\n        }\n    }\n\n    flush(): Promise<boolean> | undefined {\n        if (this._isSuspended) return;\n        this.requestNextFlush();\n        return this.waitForAllDownstream();\n    }\n\n    async waitForAllDownstream(timeout?: number): Promise<boolean> {\n        // Prepare timeout detector\n        const baseTasks = [] as Promise<unknown>[];\n        if (timeout) {\n            baseTasks.push(delay(timeout, RESULT_TIMED_OUT))\n        }\n        do {\n            const idleTasks = this.idleDetectors();\n            const tasks = [...baseTasks, Promise.all(idleTasks)];\n            const ret = await Promise.race(tasks);\n            if (ret === RESULT_TIMED_OUT) return false;\n        } while (!this.isIdle());\n        return true;\n    }\n\n    waitForAllProcessed(timeout?: number): Promise<boolean> {\n        this.root.startPipeline();\n        return this.root.waitForAllDownstream(timeout);\n    }\n    async waitForAllDoneAndTerminate(timeout?: number): Promise<boolean> {\n        this.root.startPipeline();\n        const r = await this.root.waitForAllDownstream(timeout);\n        this.terminateAll();\n        return r;\n    }\n    async _runProcessor(items: T[]): Promise<void> {\n        // runProcessor does not modify queue. so updateStatus should only update about reactiveSource.\n        const ret = await this._processor(items);\n        if (!ret) return;\n        // If downstream is connected, the result sent to that.\n        if (this._pipeTo) {\n            this._pipeTo.enqueueAll(ret);\n        } else if (this._keepResultUntilDownstreamConnected) {\n            // Buffer the result if downstream is not connected.\n            this._keptResult.push(...ret);\n        }\n    }\n    async * pump(): AsyncGenerator<T[], void, unknown> {\n        let items: T[];\n        let queueRunOut = true;\n        do {\n            if (!this._canCollectBatch()) {\n                // If we cannot collect any items from the queue, sleep until a next notify\n                queueRunOut = true;\n                await Promise.race([this._notifier.nextNotify, delay(3000)]);\n                continue;\n            }\n            // Here, we have some items in the queue.\n            if (queueRunOut) {\n                // If the pump has been slept, wait for the chance to accumulate some more in the queue.\n                await this.delayUntilRequested(this.delay);\n            }\n            items = this._collectBatch();\n            // If the queue has been modified (by modifyQueue or something).\n            // We have to try from the begin again.\n            if (items.length == 0) {\n                continue;\n            }\n            yield items;\n            // For subsequent processes, check run out status\n            if (this._canCollectBatch()) {\n                queueRunOut = false;\n            }\n        } while (this._canCollectBatch() && !this._isSuspended)\n    }\n    _processingBatches: Set<number> = new Set<number>();\n    addProcessingBatch: (typeof this._processingBatches.add) = (value) => {\n        const r = this._processingBatches.add(value);\n        this._updateBatchProcessStatus();\n        return r;\n    }\n    deleteProcessingBatch: (typeof this._processingBatches.delete) = (value) => {\n        const r = this._processingBatches.delete(value);\n        this._updateBatchProcessStatus();\n        return r;\n    }\n    _processing: boolean = false;\n\n    async delayUntilRequested(delayMs: number): Promise<void> {\n        if (this._nextProcessNeedsImmediate) {\n            this._nextProcessNeedsImmediate = false;\n            return;\n        }\n        const delayTimer = delay(delayMs, RESULT_TIMED_OUT);\n        let ret;\n        do {\n            ret = await Promise.race([this._notifier.nextNotify, delayTimer]);\n        } while (\n            ret !== RESULT_TIMED_OUT &&\n            this._nextProcessNeedsImmediate === false &&\n            this.yieldThreshold >= this._queue.length\n        )\n        this._nextProcessNeedsImmediate = false;\n        return;\n    }\n\n    async _process(): Promise<void> {\n        if (this._processing && this._isSuspended) return;\n        let lastProcessBegin = 0;\n        try {\n            this._processing = true;\n            do {\n                const batchPump = this.pump()\n                for await (const batch of batchPump) {\n                    const batchLength = batch.length;\n                    this.updateStatus(() => {\n                        this.waitingEntries += batchLength;\n                    })\n                    while (this._processingBatches.size >= this.concurrentLimit) {\n                        await this._notifier.nextNotify;\n                    }\n                    // Add batch to the processing\n                    const key = Date.now() + Math.random();\n                    const batchTask = async () => {\n                        this.updateStatus(() => {\n                            // To avoid false positive of idle, add processingEntities before reducing waitingEntries\n                            this.processingEntities += batchLength;\n                            this.waitingEntries -= batchLength;\n                        });\n                        this.addProcessingBatch(key);\n                        try {\n                            if (this.interval && lastProcessBegin) {\n                                const diff = Date.now() - lastProcessBegin;\n                                if (diff < this.interval) {\n                                    const delayMs = this.interval - diff;\n                                    await delay(delayMs);\n                                }\n                            }\n                            lastProcessBegin = Date.now();\n                            await this._runProcessor(batch);\n                        } catch (ex) {\n                            Logger(`Processor error!`);\n                            Logger(ex, LOG_LEVEL_VERBOSE);\n                        } finally {\n                            this.deleteProcessingBatch(key);\n                            this.updateStatus(() => {\n                                this.processingEntities -= batchLength;\n                            });\n                            this._notifier.notify();\n                        }\n                    }\n\n                    this._notifier.notify();\n                    fireAndForget(() => batchTask());\n                }\n                await this._notifier.nextNotify;\n            } while (!this._isSuspended)\n        } finally {\n            this._processing = false;\n        }\n    }\n\n    _run(): void {\n        if (this._isSuspended) return;\n        if (this._processing) return;\n        fireAndForget(() => this._process());\n    }\n    terminateAll(): void {\n        this.root.terminate();\n    }\n    terminate(): void {\n        if (this._pipeTo) {\n            this._pipeTo.terminate();\n            this._pipeTo = undefined;\n        }\n        this._isSuspended = true;\n        this._enqueueProcessor = () => [];\n        this._processor = () => Promise.resolve([]);\n        this.clearQueue();\n        this._notifier.notify();\n        this._notifier.notify();\n        this._notifier.notify();\n        this._queue.length = 0;\n        allRunningProcessors.delete(this);\n    }\n}\n\nexport function stopAllRunningProcessors(): void {\n    const processors = [...allRunningProcessors];\n    for (const processor of processors) {\n        processor.terminate();\n    }\n}"],"names":[],"mappings":"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"}