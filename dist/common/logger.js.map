{"version":3,"file":"logger.js","sources":["../../src/common/logger.ts"],"sourcesContent":["export const LOG_LEVEL_DEBUG = -1;\nexport const LOG_LEVEL_VERBOSE = 0b00010000;\nexport const LOG_LEVEL_INFO = 0b00100000;\nexport const LOG_LEVEL_NOTICE = 0b01000000;\nexport const LOG_LEVEL_URGENT = 0b10000000;\n\nexport const LOG_KIND_INFO = 0b00000000;\nexport const LOG_KIND_DEBUG = 0b00000001;\nexport const LOG_KIND_VERBOSE = 0b00000010;\nexport const LOG_KIND_WARNING = 0b00000100;\nexport const LOG_KIND_ERROR = 0b00001000;\n\nexport type LOG_LEVEL = (typeof LOG_LEVEL_DEBUG | typeof LOG_LEVEL_VERBOSE | typeof LOG_LEVEL_INFO | typeof LOG_LEVEL_NOTICE | typeof LOG_LEVEL_URGENT);\n\nexport const LEVEL_DEBUG = LOG_LEVEL_DEBUG;\nexport const LEVEL_INFO = LOG_LEVEL_INFO;\nexport const LEVEL_NOTICE = LOG_LEVEL_NOTICE;\nexport const LEVEL_URGENT = LOG_LEVEL_URGENT;\nexport const LEVEL_VERBOSE = LOG_LEVEL_VERBOSE;\n\nexport type LOG_KIND = (typeof LOG_KIND_INFO | typeof LOG_KIND_DEBUG | typeof LOG_KIND_VERBOSE | typeof LOG_KIND_WARNING | typeof LOG_KIND_ERROR);\n\nexport type LoggerFunction = typeof defaultLogger;\n\nexport const defaultLoggerEnv = {\n    minLogLevel: LOG_LEVEL_INFO\n}\nconst defaultLogger = function defaultLogger(message: any, level: number = LEVEL_INFO, key?: string) {\n    if (level < defaultLoggerEnv.minLogLevel) {\n        return;\n    }\n    const now = new Date();\n    const timestamp = now.toLocaleString();\n    const messageContent = typeof message == \"string\" ? message : message instanceof Error ? `${message.name}:${message.message}` : JSON.stringify(message, null, 2);\n    const newMessage = `${timestamp}\\t${level}\\t${messageContent}`;\n    if (level & LOG_KIND_DEBUG) {\n        console.debug(newMessage);\n    }\n    else if (level & LOG_KIND_WARNING) {\n        console.warn(newMessage);\n    }\n    else if (level & LOG_KIND_ERROR) {\n        console.error(newMessage);\n    }\n    else if (level & LOG_KIND_VERBOSE) {\n        console.info(newMessage);\n    }\n    else {\n        console.log(newMessage);\n    }\n    if (message instanceof Error) {\n        // debugger;\n        console.dir(message.stack);\n    }\n};\n\nlet _logger: LoggerFunction = defaultLogger;\n\n/**\n * Sets the global log function.\n * \n * @param logger - The logger function to set as the global log function.\n */\nexport function setGlobalLogFunction(logger: LoggerFunction) {\n    _logger = logger;\n}\n/**\n * Logs a message with an optional log level and key.\n * \n * @param message - The message to be logged.\n * @param level - The log level (optional).\n * @param key - The key (optional).\n */\nexport function Logger(message: any, level?: LOG_LEVEL, key?: string): void {\n    _logger(message, level, key);\n}\n\nfunction __logger(message: any, baseLevel: LOG_LEVEL, flagsOrKey?: LOG_KIND | string, key?: string) {\n    let level = baseLevel;\n    if (typeof flagsOrKey == \"string\") {\n        key = flagsOrKey;\n    }\n    else if (flagsOrKey !== undefined) {\n        level |= flagsOrKey;\n    }\n    _logger(message, level, key);\n}\n\nexport function info(message: any): void;\nexport function info(message: any, flags: LOG_KIND): void;\nexport function info(message: any, key: string): void;\nexport function info(message: any, flags: LOG_KIND, key: string): void;\nexport function info(message: any, flagsOrKey?: LOG_KIND | string, key?: string): void {\n    __logger(message, LEVEL_INFO, flagsOrKey, key);\n}\n\nexport function debug(message: any): void;\nexport function debug(message: any, flags: LOG_KIND): void;\nexport function debug(message: any, key: string): void;\nexport function debug(message: any, flags: LOG_KIND, key: string): void;\nexport function debug(message: any, flagsOrKey?: LOG_KIND | string, key?: string): void {\n    __logger(message, LEVEL_INFO, flagsOrKey, key);\n}\n\nexport function verbose(message: any): void;\nexport function verbose(message: any, flags: LOG_KIND): void;\nexport function verbose(message: any, key: string): void;\nexport function verbose(message: any, flags: LOG_KIND, key: string): void;\nexport function verbose(message: any, flagsOrKey?: LOG_KIND | string, key?: string): void {\n    __logger(message, LEVEL_INFO, flagsOrKey, key);\n}\n\nexport function notice(message: any): void;\nexport function notice(message: any, flags: LOG_KIND): void;\nexport function notice(message: any, key: string): void;\nexport function notice(message: any, flags: LOG_KIND, key: string): void;\nexport function notice(message: any, flagsOrKey?: LOG_KIND | string, key?: string): void {\n    __logger(message, LEVEL_INFO, flagsOrKey, key);\n}"],"names":[],"mappings":"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"}