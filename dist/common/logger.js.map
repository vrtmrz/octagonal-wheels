{"version":3,"file":"logger.js","sources":["../../src/common/logger.ts"],"sourcesContent":["export const LOG_LEVEL_DEBUG = -1;\r\nexport const LOG_LEVEL_VERBOSE = 0b00010000;\r\nexport const LOG_LEVEL_INFO = 0b00100000;\r\nexport const LOG_LEVEL_NOTICE = 0b01000000;\r\nexport const LOG_LEVEL_URGENT = 0b10000000;\r\n\r\nexport const LOG_KIND_INFO = 0b00000000;\r\nexport const LOG_KIND_DEBUG = 0b00000001;\r\nexport const LOG_KIND_VERBOSE = 0b00000010;\r\nexport const LOG_KIND_WARNING = 0b00000100;\r\nexport const LOG_KIND_ERROR = 0b00001000;\r\n\r\nexport type LOG_LEVEL = (typeof LOG_LEVEL_DEBUG | typeof LOG_LEVEL_VERBOSE | typeof LOG_LEVEL_INFO | typeof LOG_LEVEL_NOTICE | typeof LOG_LEVEL_URGENT);\r\n\r\nexport const LEVEL_DEBUG = LOG_LEVEL_DEBUG;\r\nexport const LEVEL_INFO = LOG_LEVEL_INFO;\r\nexport const LEVEL_NOTICE = LOG_LEVEL_NOTICE;\r\nexport const LEVEL_URGENT = LOG_LEVEL_URGENT;\r\nexport const LEVEL_VERBOSE = LOG_LEVEL_VERBOSE;\r\n\r\nexport type LOG_KIND = (typeof LOG_KIND_INFO | typeof LOG_KIND_DEBUG | typeof LOG_KIND_VERBOSE | typeof LOG_KIND_WARNING | typeof LOG_KIND_ERROR);\r\n\r\nexport type LoggerFunction = typeof defaultLogger;\r\n\r\nexport const defaultLoggerEnv = {\r\n    minLogLevel: LOG_LEVEL_INFO\r\n}\r\nconst defaultLogger = function defaultLogger(message: any, level: number = LEVEL_INFO, key?: string) {\r\n    if (level < defaultLoggerEnv.minLogLevel) {\r\n        return;\r\n    }\r\n    const now = new Date();\r\n    const timestamp = now.toLocaleString();\r\n    const messageContent = typeof message == \"string\" ? message : message instanceof Error ? `${message.name}:${message.message}` : JSON.stringify(message, null, 2);\r\n    const newMessage = `${timestamp}\\t${level}\\t${messageContent}`;\r\n    if (level & LOG_KIND_DEBUG) {\r\n        console.debug(newMessage);\r\n    }\r\n    else if (level & LOG_KIND_WARNING) {\r\n        console.warn(newMessage);\r\n    }\r\n    else if (level & LOG_KIND_ERROR) {\r\n        console.error(newMessage);\r\n    }\r\n    else if (level & LOG_KIND_VERBOSE) {\r\n        console.info(newMessage);\r\n    }\r\n    else {\r\n        console.log(newMessage);\r\n    }\r\n    if (message instanceof Error) {\r\n        // debugger;\r\n        console.dir(message.stack);\r\n    }\r\n};\r\n\r\nlet _logger: LoggerFunction = defaultLogger;\r\n\r\n/**\r\n * Sets the global log function.\r\n * \r\n * @param logger - The logger function to set as the global log function.\r\n */\r\nexport function setGlobalLogFunction(logger: LoggerFunction) {\r\n    _logger = logger;\r\n}\r\n/**\r\n * Logs a message with an optional log level and key.\r\n * \r\n * @param message - The message to be logged.\r\n * @param level - The log level (optional).\r\n * @param key - The key (optional).\r\n */\r\nexport function Logger(message: any, level?: LOG_LEVEL, key?: string): void {\r\n    _logger(message, level, key);\r\n}\r\n\r\nfunction __logger(message: any, baseLevel: LOG_LEVEL, flagsOrKey?: LOG_KIND | string, key?: string) {\r\n    let level = baseLevel;\r\n    if (typeof flagsOrKey == \"string\") {\r\n        key = flagsOrKey;\r\n    }\r\n    else if (flagsOrKey !== undefined) {\r\n        level |= flagsOrKey;\r\n    }\r\n    _logger(message, level, key);\r\n}\r\n\r\nexport function info(message: any): void;\r\nexport function info(message: any, flags: LOG_KIND): void;\r\nexport function info(message: any, key: string): void;\r\nexport function info(message: any, flags: LOG_KIND, key: string): void;\r\nexport function info(message: any, flagsOrKey?: LOG_KIND | string, key?: string): void {\r\n    __logger(message, LEVEL_INFO, flagsOrKey, key);\r\n}\r\n\r\nexport function debug(message: any): void;\r\nexport function debug(message: any, flags: LOG_KIND): void;\r\nexport function debug(message: any, key: string): void;\r\nexport function debug(message: any, flags: LOG_KIND, key: string): void;\r\nexport function debug(message: any, flagsOrKey?: LOG_KIND | string, key?: string): void {\r\n    __logger(message, LEVEL_INFO, flagsOrKey, key);\r\n}\r\n\r\nexport function verbose(message: any): void;\r\nexport function verbose(message: any, flags: LOG_KIND): void;\r\nexport function verbose(message: any, key: string): void;\r\nexport function verbose(message: any, flags: LOG_KIND, key: string): void;\r\nexport function verbose(message: any, flagsOrKey?: LOG_KIND | string, key?: string): void {\r\n    __logger(message, LEVEL_INFO, flagsOrKey, key);\r\n}\r\n\r\nexport function notice(message: any): void;\r\nexport function notice(message: any, flags: LOG_KIND): void;\r\nexport function notice(message: any, key: string): void;\r\nexport function notice(message: any, flags: LOG_KIND, key: string): void;\r\nexport function notice(message: any, flagsOrKey?: LOG_KIND | string, key?: string): void {\r\n    __logger(message, LEVEL_INFO, flagsOrKey, key);\r\n}"],"names":[],"mappings":"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"}